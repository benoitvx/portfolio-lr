---
interface Props {
  title: string;
  description?: string;
  image: string;
  href: string;
  date?: Date;
  category?: string;
}

const { title, description, image, href, date, category } = Astro.props;

const formattedDate = date
  ? new Intl.DateTimeFormat('fr-FR', {
      day: 'numeric',
      month: 'long',
      year: 'numeric',
    }).format(date)
  : null;
---

<article class="group">
  <a href={href} class="block">
    <!-- Image container avec ratio 4:3 -->
    <div class="relative aspect-[4/3] overflow-hidden rounded-sm bg-[--color-bg-alt]">
      <img
        src={image}
        alt={title}
        loading="lazy"
        decoding="async"
        class="w-full h-full object-cover transition-transform duration-500 ease-out group-hover:scale-105"
      />
      <!-- Overlay subtil au hover -->
      <div class="absolute inset-0 bg-[--color-primary-dark]/0 group-hover:bg-[--color-primary-dark]/10 transition-colors duration-300" />
    </div>

    <!-- Contenu texte -->
    <div class="mt-4 space-y-2">
      {(category || formattedDate) && (
        <div class="flex items-center gap-3 text-sm text-[--color-text-light]">
          {category && (
            <span class="uppercase tracking-wide text-xs text-[--color-primary]">
              {category}
            </span>
          )}
          {category && formattedDate && (
            <span class="text-[--color-accent]">&middot;</span>
          )}
          {formattedDate && (
            <time datetime={date?.toISOString()}>
              {formattedDate}
            </time>
          )}
        </div>
      )}

      <h3 class="font-serif text-xl text-[--color-text] group-hover:text-[--color-primary] transition-colors">
        {title}
      </h3>

      {description && (
        <p class="text-[--color-text-light] text-base line-clamp-2">
          {description}
        </p>
      )}
    </div>
  </a>
</article>

<style>
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style>
